# إضافة نظام تنبيهات TikTok

سنقوم بإضافة نظام متكامل لمراقبة حسابات TikTok باستخدام مكتبة `yt-dlp` لاستخراج البيانات، حيث تعد الخيار الأفضل والمجاني حالياً لتجاوز حمايات TikTok الأساسية.

## 1. التجهيز والإعدادات
*   تثبيت مكتبة `yt-dlp` (ضرورية لجلب معلومات الفيديو).
*   إنشاء ملف `tiktok_data.json` لتخزين الحسابات المراقبة ومعرف آخر فيديو (Last Video ID) وروم الإشعارات.

## 2. أوامر التحكم (Slash Commands)
سننشئ مجموعة أوامر تحت مسمى `/tiktok`:
*   `/tiktok set_channel`: لتحديد الروم الذي ستصل إليه التنبيهات.
*   `/tiktok add <username>`: لإضافة حساب للمراقبة (سيقوم البوت بجلب آخر فيديو وحفظه كمرجع).
*   `/tiktok remove <username>`: لحذف حساب من المراقبة.
*   `/tiktok list`: لعرض جميع الحسابات المراقبة حالياً.
*   `/tiktok check`: (للمشرفين) لإجبار البوت على الفحص فوراً.

## 3. نظام المراقبة التلقائي (Background Task)
*   إنشاء مهمة خلفية (`tasks.loop`) تعمل كل **10 دقائق** (توقيت آمن لتجنب الحظر).
*   تقوم المهمة بالمرور على كل حساب محفوظ.
*   استخدام `yt-dlp` لجلب "أحدث فيديو" في القائمة.
*   مقارنة معرف الفيديو (Video ID) مع المعرف المحفوظ.
*   إذا كان مختلفاً -> يتم إرسال الرابط في ديسكورد وحفظ المعرف الجديد.

## 4. التعامل مع الأخطاء
*   إضافة حماية (`try/except`) عشان لو TikTok حجب الطلب، البوت ما يطفي، بس يكتب في الكونسول "فشل الفحص مؤقتاً".
